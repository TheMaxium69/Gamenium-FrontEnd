<section id="editedmygame" class="container" *ngIf="selectedMyGame">

<form #editedMyGame="ngForm" (ngSubmit)="updateMyGame(editedMyGame)">

  <section id="headeEditMyGame">

    <div id="head-img">
      <div class="banner-image pp-shadow">
        <div class="banner" style="background-image: url({{ selectedMyGame.myGame?.game?.image?.thumb_url}});"></div>
        <div class="blur"></div>
        <img class="back" src="{{ selectedMyGame.myGame?.game?.image?.thumb_url }}" alt="blur">
      </div>
      <div class="separe-image"></div>
      <div class="screen-image" [ngStyle]="{'--color-variable': this.app.userConnected?.themeColor || this.app.colorDefault}">
        <small>Image Utilisateur</small>
        <div class="screen-all">
          <ng-container *ngFor="let oneScreen of [].constructor(10)"> <!-- this.app.viewMyGame.screenshot-->
            <div class="screen-encard">
              <img class="screen" [src]="selectedMyGame.myGame?.game?.image?.thumb_url" alt="userImage">
            </div>
          </ng-container>
        </div>
      </div>
    </div>

    <div id="head-modal">

      <div>
        <h2 class="titleGame">{{ selectedMyGame.myGame?.game?.name }}</h2>
        <small>Ajouté le {{ selectedMyGame.myGame?.added_at | date:'dd / MM / yyyy' }}</small>
      </div>


      <button class="main-gamenium-btn" routerLink="/game/{{ selectedMyGame.myGame.game.id }}" data-bs-dismiss="modal" style="background-color: {{ this.app.userConnected?.themeColor || this.app.colorDefault }}">Voir le jeux</button>

    </div>

  </section>

  <ng-container *ngIf="selectedMyGame.myGame">
  <div id="startFormEditedMyGame">

    <input type="hidden" [(ngModel)]="selectedMyGame.myGame.id" name="myGameId">

    <!-- EPINGLER -->
    <div class="panel">

      <div class="head-panel">
        <h2><i class="ri-pushpin-fill"></i>Épinglé</h2>
      </div>


      <label for="is_pinned_true">
        <input type="radio" id="is_pinned_true" [(ngModel)]="selectedMyGame.myGame.is_pinned" name="is_pinned"
               [value]="true">
        Épinglé
      </label>
      <label for="is_pinned_false">
        <input type="radio" id="is_pinned_false" [(ngModel)]="selectedMyGame.myGame.is_pinned" name="is_pinned"
               [value]="false">
        Non épinglé
      </label>

    </div>

    <!-- LISTE DE SOUHAIT-->
    <div class="panel" style="display: none">

      <div class="head-panel">
        <h2>List de souhait</h2>
      </div>

      <label for="wish_list_yes">
        <input type="radio" id="wish_list_yes" [(ngModel)]="selectedMyGame.myGame.wish_list" name="wish_list"
               [value]="true">
        Oui
      </label>
      <label for="wish_list_no">
        <input type="radio" id="wish_list_no" [(ngModel)]="selectedMyGame.myGame.wish_list" name="wish_list"
               [value]="false">
        Non
      </label>

    </div>

    <div class="panel">

      <div class="head-panel">
        <h2><i class="ri-user-star-fill"></i>Evaluation</h2>
      </div>

      <!-- NOTE GLOBAL -->
      <label for="rating">Note Game:</label>
      <ng-container *ngIf="selectedMyGame.rate">
        <input type="hidden" [(ngModel)]="selectedMyGame.rate.id" name="rateId">
        <input type="number" id="rating" [(ngModel)]="selectedMyGame.rate.rating" name="rating">
      </ng-container>
      <ng-container *ngIf="!selectedMyGame.rate">
        <input type="number" id="rating" name="rating" ngModel>
      </ng-container>

      <!-- DIFICULTER -->
      <label >Difficulty rating:</label>
      <label for="difficulty_rating_1">
        <input type="radio" id="difficulty_rating_1" [(ngModel)]="selectedMyGame.myGame.difficulty_rating"
               name="difficulty_rating" [value]="1">
        1
      </label>
      <label for="difficulty_rating_2">
        <input type="radio" id="difficulty_rating_2" [(ngModel)]="selectedMyGame.myGame.difficulty_rating"
               name="difficulty_rating" [value]="2">
        2
      </label>
      <label for="difficulty_rating_3">
        <input type="radio" id="difficulty_rating_3" [(ngModel)]="selectedMyGame.myGame.difficulty_rating"
               name="difficulty_rating" [value]="3">
        3
      </label>
      <label for="difficulty_rating_4">
        <input type="radio" id="difficulty_rating_4" [(ngModel)]="selectedMyGame.myGame.difficulty_rating"
               name="difficulty_rating" [value]="4">
        4
      </label>
      <label for="difficulty_rating_5">
        <input type="radio" id="difficulty_rating_5" [(ngModel)]="selectedMyGame.myGame.difficulty_rating"
               name="difficulty_rating" [value]="5">
        5
      </label>

      <!-- TEMPS DE JEUX -->
      <label>Lifetime rating:</label>
      <label for="lifetime_rating_1">
        <input type="radio" id="lifetime_rating_1" [(ngModel)]="selectedMyGame.myGame.lifetime_rating"
               name="lifetime_rating" [value]="1">
        1
      </label>
      <label for="lifetime_rating_2">
        <input type="radio" id="lifetime_rating_2" [(ngModel)]="selectedMyGame.myGame.lifetime_rating"
               name="lifetime_rating" [value]="2">
        2
      </label>
      <label for="lifetime_rating_3">
        <input type="radio" id="lifetime_rating_3" [(ngModel)]="selectedMyGame.myGame.lifetime_rating"
               name="lifetime_rating" [value]="3">
        3
      </label>
      <label for="lifetime_rating_4">
        <input type="radio" id="lifetime_rating_4" [(ngModel)]="selectedMyGame.myGame.lifetime_rating"
               name="lifetime_rating" [value]="4">
        4
      </label>
      <label for="lifetime_rating_5">
        <input type="radio" id="lifetime_rating_5" [(ngModel)]="selectedMyGame.myGame.lifetime_rating"
               name="lifetime_rating" [value]="5">
        5
      </label>
    </div>

    <!-- EXEMPLAIRE -->
    <div>
      <h1>Exemplaire <span>{{ nbCopyView }}{{ noRealCopy() }}</span> :</h1>
      <button type="button" (click)="addCopyGame()">Ajouter un exemplaire</button>
      <button type="button" (click)="debug()">debug</button>
      <ng-container *ngFor="let copyGame of selectedMyGame.copyGame; let i = index">

        <div class="oneExemplaire copyCard{{i}}" id="copyCard{{i}}">
          <h1>Form ID {{i}}</h1>
          <button type="button" (click)="deleteCopyGame(i)">Del cette exemplaire</button>

          <input type="hidden" [(ngModel)]="copyGame.id" name="copy{{i}}">

          <!-- EDITIONS-->
          <div class="panel">
            <div class="head-panel">
              <h2><i class="ri-id-card-fill"></i>Editions</h2>
            </div>
            <input type="text" id="edition{{i}}" [(ngModel)]="copyGame.edition" name="edition{{i}}" placeholder="Editions">
          </div>

          <!-- BARCODE -->
          <div class="panel">
            <div class="head-panel">
              <h2><i class="ri-barcode-fill"></i>Barcode</h2>
            </div>
            <input type="text" id="barcode{{i}}" [(ngModel)]="copyGame.barcode" name="barcode{{i}}" placeholder="Barcode">
          </div>

          <!-- CONTENT -->
          <div class="panel">
            <div class="head-panel">
              <h2><i class="ri-message-2-fill"></i>Description de l'exemplaire</h2>
            </div>
            <textarea type="text" id="content{{i}}" [(ngModel)]="copyGame.content" name="content{{i}}" placeholder="Description de l'exemplaire"></textarea>
          </div>

          <!-- ETAT -->
          <div class="panel">
            <div class="head-panel">
              <h2>Etat</h2>
            </div>
            <ng-container *ngIf="hmgCopyEtatAll && copyGame.etat">
              <select id="etat{{i}}" [(ngModel)]="copyGame.etat.id" name="etat{{i}}">
                <option [value]="null">Choissir un etat</option>
                <ng-container *ngFor="let etat of hmgCopyEtatAll">
                  <option [value]="etat.id">{{ etat.name }}</option>
                </ng-container>
              </select>
            </ng-container>
            <ng-container *ngIf="hmgCopyEtatAll && !copyGame.etat">
              <select id="etat{{i}}" name="etat{{i}}" ngModel>
                <option [value]="null">Choissir un etat</option>
                <ng-container *ngFor="let etat of hmgCopyEtatAll">
                  <option [value]="etat.id">{{ etat.name }}</option>
                </ng-container>
              </select>
            </ng-container>
          </div>

          <!-- FORMAT -->
          <div class="panel">
            <div class="head-panel">
              <h2>Format</h2>
            </div>
            <ng-container *ngIf="hmgCopyFormatAll && copyGame.format">
              <select id="format{{i}}" [(ngModel)]="copyGame.format.id" name="format{{i}}">
                <option [value]="null">Choissir un format</option>
                <ng-container *ngFor="let format of hmgCopyFormatAll">
                  <option [value]="format.id">{{ format.name }}</option>
                </ng-container>
              </select>
            </ng-container>
            <ng-container *ngIf="hmgCopyFormatAll && !copyGame.format">
              <select id="format{{i}}" name="format{{i}}" ngModel>
                <option [value]="null">Choissir un format</option>
                <ng-container *ngFor="let format of hmgCopyFormatAll">
                  <option [value]="format.id">{{ format.name }}</option>
                </ng-container>
              </select>
            </ng-container>
          </div>

          <!-- REGION -->
          <div class="panel">
            <div class="head-panel">
              <h2>Region</h2>
            </div>
            <ng-container *ngIf="hmgCopyRegionAll && copyGame.region">
              <select id="region{{i}}" [(ngModel)]="copyGame.region.id" name="region{{i}}">
                <option [value]="null">Choissir une Region</option>
                <ng-container *ngFor="let region of hmgCopyRegionAll">
                  <option [value]="region.id">{{ region.name }}</option>
                </ng-container>
              </select>
            </ng-container>
            <ng-container *ngIf="hmgCopyRegionAll && !copyGame.region">
              <select id="region{{i}}" name="region{{i}}" ngModel>
                <option [value]="null">Choissir une Region</option>
                <ng-container *ngFor="let region of hmgCopyRegionAll">
                  <option [value]="region.id">{{ region.name }}</option>
                </ng-container>
              </select>
            </ng-container>
          </div>

          <br>
          <hr>

          <!-- PURCHASE -->
          <div class="panel">

            <div class="head-panel">
              <h2>Purchase</h2>
              <i class="ri-more-2-fill"></i>
            </div>
            <ng-container *ngIf="copyGame.purchase">

              <input type="hidden" [(ngModel)]="copyGame.purchase.id" name="purchase{{i}}">

              <!-- PRICE -->
              <label for="price{{i}}">Price:</label>
              <input type="number" id="price{{i}}" [(ngModel)]="copyGame.purchase.price" name="purchase_price{{i}}">

              <!-- DEVISE -->
              <label for="devise{{i}}">Devise:</label>
              <ng-container *ngIf="deviseAll && copyGame.purchase.devise">
                <select id="devise{{i}}" [(ngModel)]="copyGame.purchase.devise.id" name="purchase_devise{{i}}">
                  <option [value]="null">Choissir une devise</option>
                  <ng-container *ngFor="let devise of deviseAll">
                    <option [value]="devise.id">{{ devise.symbole }}</option>
                  </ng-container>
                </select>
              </ng-container>
              <ng-container *ngIf="deviseAll && !copyGame.purchase.devise">
                <select id="devise{{i}}" name="purchase_devise{{i}}" ngModel>
                  <option [value]="null">Choissir une devise</option>
                  <ng-container *ngFor="let devise of deviseAll">
                    <option [value]="devise.id">{{ devise.symbole }}</option>
                  </ng-container>
                </select>
              </ng-container>

              <!-- BUY DATE -->
              <label for="buy_date{{i}}">Buy date:</label>
              <input type="date" id="buy_date{{i}}" [(ngModel)]="copyGame.purchase.buy_date"
                     name="purchase_buy_date{{i}}">

              <!-- BUY WHERE -->
              <label for="buy_where{{i}}">Buy where:</label>
<!--              <input type="text" id="buy_where{{i}}" [(ngModel)]="copyGame.purchase.buy_where.name" name="purchase_buy_where{{i}}">-->
              <ng-container *ngIf="buyWhereAll && copyGame.purchase.buy_where">
                <select id="buy_where{{i}}" [(ngModel)]="copyGame.purchase.buy_where.id" name="purchase_buy_where{{i}}">
                  <option [value]="null">Choissir une Buy Where</option>
                  <ng-container *ngFor="let buyWhereOne of buyWhereAll">
                    <option [value]="buyWhereOne.id">{{ buyWhereOne.name }}</option>
                  </ng-container>
                </select>
              </ng-container>
              <ng-container *ngIf="buyWhereAll && !copyGame.purchase.buy_where">
                <select id="buy_where{{i}}" name="purchase_buy_where{{i}}" ngModel>
                  <option [value]="null">Choissir une Buy Where</option>
                  <ng-container *ngFor="let buyWhereOne of buyWhereAll">
                    <option [value]="buyWhereOne.id">{{ buyWhereOne.name }}</option>
                  </ng-container>
                </select>
              </ng-container>

              <!-- PURCHASE CONTENT -->
              <label for="purchase_content{{i}}">Purchase content:</label>
              <input type="text" id="purchase_content{{i}}" [(ngModel)]="copyGame.purchase.content"
                     name="purchase_content{{i}}">

            </ng-container>
            <ng-container *ngIf="!copyGame.purchase">

              <!-- PRICE -->
              <label for="price{{i}}">Price:</label>
              <input type="number" id="price{{i}}" name="purchase_price{{i}}" ngModel>

              <!-- DEVISE -->
              <label for="devise{{i}}">Devise:</label>
              <ng-container *ngIf="deviseAll">
                <select id="devise{{i}}" name="purchase_devise{{i}}" ngModel>
                  <option [value]="null">Choissir une devise</option>
                  <ng-container *ngFor="let devise of deviseAll">
                    <option [value]="devise.id">{{ devise.symbole }}</option>
                  </ng-container>
                </select>
              </ng-container>

              <!-- BUY DATE -->
              <label for="buy_date{{i}}">Buy date:</label>
              <input type="date" id="buy_date{{i}}" name="purchase_buy_date{{i}}" ngModel>

              <!-- BUY WHERE -->
              <label for="buy_where{{i}}">Buy where:</label>
              <ng-container *ngIf="buyWhereAll">
                <select id="buy_where{{i}}" name="purchase_buy_where{{i}}" ngModel>
                  <option [value]="null">Choissir une Buy Where</option>
                  <ng-container *ngFor="let buyWhereOne of buyWhereAll">
                    <option [value]="buyWhereOne.id">{{ buyWhereOne.name }}</option>
                  </ng-container>
                </select>
              </ng-container>

              <!-- PURCHASE CONTENT -->
              <label for="purchase_content{{i}}">Purchase content:</label>
              <input type="text" id="purchase_content{{i}}" name="purchase_content{{i}}" ngModel>

            </ng-container>
          </div>
        </div>
      </ng-container>
      <ng-container *ngFor="let n of [].constructor(nbCopy); let i = index">
        <div class="oneExemplaire copyCard{{i}}" id="copyCard{{i+nbCopyExisting}}" style="display: {{ displayDefault(i+nbCopyExisting) }}">
          <h1>Form ID {{i + nbCopyExisting}}</h1>
          <button type="button" (click)="deleteCopyGame(i+nbCopyExisting)">Del cette exemplaire</button>

          <input type="hidden" [(ngModel)]="isNewCopy" name="copy{{i+nbCopyExisting}}">

          <!-- RESTE DU CODE -->
          <!-- EDITIONS-->
          <label for="edition{{i+nbCopyExisting}}">Editions:</label>
          <input type="text" id="edition{{i+nbCopyExisting}}" name="edition{{i+nbCopyExisting}}" ngModel>

          <!-- BARCODE -->
          <label for="barcode{{i+nbCopyExisting}}">Barcode:</label>
          <input type="text" id="barcode{{i+nbCopyExisting}}" name="barcode{{i+nbCopyExisting}}" ngModel>

          <!-- CONTENT -->
          <label for="content{{i+nbCopyExisting}}">Content:</label>
          <input type="text" id="content{{i+nbCopyExisting}}" name="content{{i+nbCopyExisting}}" ngModel>

          <!-- ETAT -->
          <label for="etat{{i+nbCopyExisting}}">Etat:</label>
          <ng-container *ngIf="hmgCopyEtatAll">
            <select id="etat{{i+nbCopyExisting}}" name="etat{{i+nbCopyExisting}}" ngModel>
              <option [value]="null">Choissir un etat</option>
              <ng-container *ngFor="let etat of hmgCopyEtatAll">
                <option [value]="etat.id">{{ etat.name }}</option>
              </ng-container>
            </select>
          </ng-container>

          <!-- FORMAT -->
          <label for="format{{i+nbCopyExisting}}">Format:</label>
          <ng-container *ngIf="hmgCopyFormatAll">
            <select id="format{{i+nbCopyExisting}}" name="format{{i+nbCopyExisting}}" ngModel>
              <option [value]="null">Choissir un format</option>
              <ng-container *ngFor="let format of hmgCopyFormatAll">
                <option [value]="format.id">{{ format.name }}</option>
              </ng-container>
            </select>
          </ng-container>

          <!-- REGION -->
          <label for="region{{i+nbCopyExisting}}">Region:</label>
          <ng-container *ngIf="hmgCopyRegionAll">
            <select id="region{{i+nbCopyExisting}}" name="region{{i+nbCopyExisting}}" ngModel>
              <option [value]="null">Choissir une Region</option>
              <ng-container *ngFor="let region of hmgCopyRegionAll">
                <option [value]="region.id">{{ region.name }}</option>
              </ng-container>
            </select>
          </ng-container>

          <br>
          <hr>

          <h5>Purchase:</h5>

          <!-- PURCHASE -->
          <input type="hidden" name="purchase{{i+nbCopyExisting}}" ngModel>

          <!-- PRICE -->
          <label for="price{{i+nbCopyExisting}}">Price:</label>
          <input type="number" id="price{{i+nbCopyExisting}}" ngModel name="purchase_price{{i+nbCopyExisting}}">

          <!-- DEVISE -->
          <label for="devise{{i+nbCopyExisting}}">Devise:</label>
          <ng-container *ngIf="deviseAll">
            <select id="devise{{i+nbCopyExisting}}" name="purchase_devise{{i+nbCopyExisting}}" ngModel>
              <option [value]="null">Choissir une devise</option>
              <ng-container *ngFor="let devise of deviseAll">
                <option [value]="devise.id">{{ devise.symbole }}</option>
              </ng-container>
            </select>
          </ng-container>

          <!-- BUY DATE -->
          <label for="buy_date{{i+nbCopyExisting}}">Buy date:</label>
          <input type="date" id="buy_date{{i+nbCopyExisting}}" ngModel
                 name="purchase_buy_date{{i+nbCopyExisting}}">

          <!-- BUY WHERE -->
          <label for="buy_where{{i+nbCopyExisting}}">Buy where:</label>
          <ng-container *ngIf="buyWhereAll">
            <select id="buy_where{{i+nbCopyExisting}}" name="purchase_buy_where{{i+nbCopyExisting}}" ngModel>
              <option [value]="null">Choissir une Buy Where</option>
              <ng-container *ngFor="let buyWhereOne of buyWhereAll">
                <option [value]="buyWhereOne.id">{{ buyWhereOne.name }}</option>
              </ng-container>
            </select>
          </ng-container>

          <!-- PURCHASE CONTENT -->
          <label for="purchase_content{{i+nbCopyExisting}}">Purchase content:</label>
          <input type="text" id="purchase_content{{i+nbCopyExisting}}" ngModel
                 name="purchase_content{{i+nbCopyExisting}}">
        </div>
      </ng-container>
    </div>
  </div>
  </ng-container>

  <button class="main-gamenium-btn" type="submit" style="background-color: {{ this.app.userConnected?.themeColor || this.app.colorDefault }}">Sauvegardé</button>
</form>

  <button class="sub-gamenium-btn" (click)="this.app.deleteMyGame(idOneMyGame)">Supprimer le jeux de votre collection</button>
</section>


